# üß† NEURONA ARTIFICIAL PARA PREDICCI√ìN DE FUMADORES
## Documentaci√≥n T√©cnica Completa

**Autor:** Manuel Contreras Castillo  
**Actividad:** Estructura de una neurona artificial  
**Fecha:** Octubre 2024  
**Dataset:** Smoking and Drinking Dataset (500,000 registros)  
**Fuente de datos:** MongoDB Atlas - Kaggle

---

## üìã √çNDICE

1. [Introducci√≥n](#introducci√≥n)
2. [Arquitectura de la Neurona](#arquitectura)
3. [¬øQu√© Predice la Neurona?](#predicci√≥n)
4. [Funcionamiento Paso a Paso](#funcionamiento)
5. [Proceso de Entrenamiento](#entrenamiento)
6. [Caracter√≠sticas del Modelo](#caracter√≠sticas)
7. [Resultados y M√©tricas](#resultados)
8. [C√≥digo Implementado](#c√≥digo)
9. [Conclusiones](#conclusiones)

---

## 1. INTRODUCCI√ìN {#introducci√≥n}

### ¬øQu√© es una Neurona Artificial?

Una neurona artificial es la unidad b√°sica de procesamiento en el aprendizaje autom√°tico, inspirada en las neuronas biol√≥gicas del cerebro humano. Recibe m√∫ltiples entradas, las procesa mediante pesos aprendidos y produce una salida.

### Objetivo del Proyecto

Crear **UNA SOLA NEURONA** (no una red neuronal completa) capaz de predecir si una persona es fumadora actualmente, bas√°ndose en 11 caracter√≠sticas de salud.

### Restricciones

- ‚úÖ Solo UNA neurona (seg√∫n requisitos de la actividad)
- ‚úÖ Clasificaci√≥n binaria: Fumador (1) o No Fumador (0)
- ‚úÖ Uso de TensorFlow
- ‚úÖ Datos desde MongoDB Atlas

---

## 2. ARQUITECTURA DE LA NEURONA {#arquitectura}

### 2.1 Estructura Completa

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ         CAPA DE ENTRADA                 ‚îÇ
‚îÇ         (11 caracter√≠sticas)            ‚îÇ
‚îÇ                                         ‚îÇ
‚îÇ  ‚Ä¢ sexo_masculino                       ‚îÇ
‚îÇ  ‚Ä¢ edad_normalizada                     ‚îÇ
‚îÇ  ‚Ä¢ presion_alta                         ‚îÇ
‚îÇ  ‚Ä¢ colesterol_alto                      ‚îÇ
‚îÇ  ‚Ä¢ trigliceridos_altos                  ‚îÇ
‚îÇ  ‚Ä¢ glucosa_alta                         ‚îÇ
‚îÇ  ‚Ä¢ bebe_alcohol                         ‚îÇ
‚îÇ  ‚Ä¢ tiene_obesidad                       ‚îÇ
‚îÇ  ‚Ä¢ tiene_sobrepeso                      ‚îÇ
‚îÇ  ‚Ä¢ cintura_alta                         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                    ‚Üì
         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
         ‚îÇ   NEURONA √öNICA  ‚îÇ
         ‚îÇ                  ‚îÇ
         ‚îÇ  ‚Ä¢ 11 pesos (W)  ‚îÇ
         ‚îÇ  ‚Ä¢ 1 sesgo (b)   ‚îÇ
         ‚îÇ  ‚Ä¢ œÉ(z) sigmoid  ‚îÇ
         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                    ‚Üì
         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
         ‚îÇ      SALIDA      ‚îÇ
         ‚îÇ                  ‚îÇ
         ‚îÇ  Probabilidad    ‚îÇ
         ‚îÇ  (0.0 - 1.0)     ‚îÇ
         ‚îÇ                  ‚îÇ
         ‚îÇ  Si > 0.5 ‚Üí 1    ‚îÇ
         ‚îÇ  Si ‚â§ 0.5 ‚Üí 0    ‚îÇ
         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### 2.2 Componentes de la Neurona

| Componente | Cantidad | Descripci√≥n |
|------------|----------|-------------|
| **Entradas** | 11 | Caracter√≠sticas de salud de la persona |
| **Pesos (W)** | 11 | Importancia de cada caracter√≠stica (aprendidos) |
| **Sesgo (b)** | 1 | T√©rmino independiente (aprendido) |
| **Funci√≥n de Activaci√≥n** | 1 | Sigmoid œÉ(z) = 1/(1+e^(-z)) |
| **Salida** | 1 | Probabilidad entre 0 y 1 |
| **Par√°metros Totales** | 12 | 11 pesos + 1 sesgo |

---

## 3. ¬øQU√â PREDICE LA NEURONA? {#predicci√≥n}

### 3.1 Pregunta Objetivo

**"¬øEsta persona es fumadora ACTUALMENTE?"**

### 3.2 Tipo de Predicci√≥n

**Clasificaci√≥n Binaria:**
- **Clase 0**: No Fumador
- **Clase 1**: Fumador Actual

### 3.3 ¬øPor qu√© solo "Fuma o No Fuma"?

Una neurona individual solo puede realizar **clasificaci√≥n binaria** (dos categor√≠as).

#### ‚úÖ Lo que UNA neurona PUEDE predecir:
- Fumador vs No fumador
- Tiene diabetes vs No tiene diabetes
- Spam vs No spam
- Aprobado vs Reprobado

#### ‚ùå Lo que UNA neurona NO puede predecir:
- ¬øCu√°ntos cigarrillos fuma? (valor num√©rico continuo)
- ¬øFumador leve, moderado o severo? (3+ categor√≠as)
- ¬øQu√© enfermedad tiene? (m√∫ltiples opciones)

Para predicciones m√°s complejas se necesita una **red neuronal** con m√∫ltiples neuronas.

### 3.4 Informaci√≥n Adicional que Proporciona

Aunque solo predice dos clases, la neurona tambi√©n proporciona:

1. **Probabilidad (nivel de confianza)**
   - 95% fumador ‚Üí MUY seguro
   - 52% fumador ‚Üí Dudoso
   - 12% fumador ‚Üí MUY seguro que NO fuma

2. **Importancia de caracter√≠sticas** (pesos aprendidos)
   - Pesos positivos grandes ‚Üí caracter√≠stica favorece "fumador"
   - Pesos negativos ‚Üí caracter√≠stica favorece "no fumador"

---

## 4. FUNCIONAMIENTO PASO A PASO {#funcionamiento}

### 4.1 Ejemplo Pr√°ctico

**Persona X con las siguientes caracter√≠sticas:**

```
Entradas (x):
x‚ÇÅ = 1    (sexo_masculino: Hombre)
x‚ÇÇ = 0.45 (edad_normalizada: Adulto)
x‚ÇÉ = 0    (presion_alta: No)
x‚ÇÑ = 1    (colesterol_alto: S√≠)
x‚ÇÖ = 0    (trigliceridos_altos: No)
x‚ÇÜ = 1    (glucosa_alta: S√≠)
x‚Çá = 1    (bebe_alcohol: S√≠)
x‚Çà = 0    (tiene_obesidad: No)
x‚Çâ = 1    (tiene_sobrepeso: S√≠)
x‚ÇÅ‚ÇÄ = 0   (cintura_alta: No)
```

### 4.2 PASO 1: Multiplicaci√≥n por Pesos (Suma Ponderada)

**F√≥rmula:**
```
z = (x‚ÇÅ √ó w‚ÇÅ) + (x‚ÇÇ √ó w‚ÇÇ) + ... + (x‚ÇÅ‚ÇÅ √ó w‚ÇÅ‚ÇÅ) + b
```

**Ejemplo con pesos aprendidos:**
```python
# Pesos despu√©s del entrenamiento (ejemplo)
w‚ÇÅ = 0.52   # sexo masculino
w‚ÇÇ = 0.31   # edad
w‚ÇÉ = -0.15  # presi√≥n alta
w‚ÇÑ = 0.42   # colesterol
w‚ÇÖ = 0.28   # triglic√©ridos
w‚ÇÜ = 0.35   # glucosa
w‚Çá = 0.48   # alcohol
w‚Çà = -0.22  # obesidad
w‚Çâ = 0.18   # sobrepeso
w‚ÇÅ‚ÇÄ = 0.25  # cintura
b = -0.10   # sesgo

# C√°lculo
z = (1√ó0.52) + (0.45√ó0.31) + (0√ó-0.15) + (1√ó0.42) + (0√ó0.28) + 
    (1√ó0.35) + (1√ó0.48) + (0√ó-0.22) + (1√ó0.18) + (0√ó0.25) + (-0.10)

z = 0.52 + 0.14 + 0 + 0.42 + 0 + 0.35 + 0.48 + 0 + 0.18 + 0 - 0.10
z = 1.99
```

**Interpretaci√≥n:**
- **z positivo y grande** ‚Üí Indica alta probabilidad de ser fumador
- **z negativo** ‚Üí Indica baja probabilidad de ser fumador
- **z cercano a 0** ‚Üí Indecisi√≥n

### 4.3 PASO 2: Funci√≥n de Activaci√≥n Sigmoid

**F√≥rmula:**
```
œÉ(z) = 1 / (1 + e^(-z))
```

**Aplicando con z = 1.99:**
```python
œÉ(1.99) = 1 / (1 + e^(-1.99))
        = 1 / (1 + 0.137)
        = 1 / 1.137
        = 0.88  (88%)
```

**Gr√°fica de Sigmoid:**
```
   œÉ(z)
1.0 |         ‚ï±‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    |       ‚ï±
0.5 |     ‚ï±  ‚Üê Umbral de decisi√≥n
    |   ‚ï±
0.0 | ‚ï±
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ z
   -5   0   +5
```

**¬øQu√© hace Sigmoid?**
- Convierte cualquier n√∫mero (-‚àû a +‚àû) en probabilidad (0 a 1)
- z muy negativo ‚Üí œÉ(z) ‚âà 0 (definitivamente NO fumador)
- z = 0 ‚Üí œÉ(z) = 0.5 (indeciso)
- z muy positivo ‚Üí œÉ(z) ‚âà 1 (definitivamente fumador)

### 4.4 PASO 3: Decisi√≥n Final

**Regla de decisi√≥n:**
```python
if œÉ(z) > 0.5:
    predicci√≥n = 1  # FUMADOR
else:
    predicci√≥n = 0  # NO FUMADOR
```

**En nuestro ejemplo:**
```python
œÉ(1.99) = 0.88
0.88 > 0.5  ‚Üí  Predicci√≥n = FUMADOR ‚úì
```

### 4.5 Resumen del Proceso

```
Persona X ‚Üí [11 caracter√≠sticas] 
              ‚Üì
        Multiplicar por pesos
              ‚Üì
        z = Œ£(x·µ¢ √ó w·µ¢) + b = 1.99
              ‚Üì
        Aplicar Sigmoid
              ‚Üì
        œÉ(z) = 0.88 (88%)
              ‚Üì
        0.88 > 0.5 ‚Üí FUMADOR
```

---

## 5. PROCESO DE ENTRENAMIENTO {#entrenamiento}

### 5.1 ¬øC√≥mo Aprende la Neurona?

El entrenamiento es el proceso donde la neurona **ajusta sus pesos** para minimizar errores.

### 5.2 Antes del Entrenamiento

```python
# Pesos aleatorios iniciales
w‚ÇÅ = 0.05   (muy peque√±o, sin significado)
w‚ÇÇ = -0.12
w‚ÇÉ = 0.31
...
b = 0.01

# Resultado: Predicciones aleatorias
Persona fumadora ‚Üí Predice: NO FUMADOR ‚ùå
Persona no fumadora ‚Üí Predice: FUMADOR ‚ùå
```

### 5.3 Durante el Entrenamiento (100 Epochs)

#### Algoritmo de Entrenamiento (Descenso de Gradiente)

```python
for epoch in range(100):
    # 1. FORWARD PASS - Hacer predicci√≥n
    z = Œ£(x·µ¢ √ó w·µ¢) + b
    predicci√≥n = œÉ(z)
    
    # 2. CALCULAR ERROR (Loss Function)
    error = -[y√ólog(predicci√≥n) + (1-y)√ólog(1-predicci√≥n)]
    
    # 3. BACKWARD PASS - Calcular gradientes
    ‚àÇerror/‚àÇw‚ÇÅ, ‚àÇerror/‚àÇw‚ÇÇ, ..., ‚àÇerror/‚àÇb
    
    # 4. ACTUALIZAR PESOS (AQU√ç APRENDE)
    w‚ÇÅ = w‚ÇÅ - (learning_rate √ó ‚àÇerror/‚àÇw‚ÇÅ)
    w‚ÇÇ = w‚ÇÇ - (learning_rate √ó ‚àÇerror/‚àÇw‚ÇÇ)
    ...
    b = b - (learning_rate √ó ‚àÇerror/‚àÇb)
```

#### Funci√≥n de P√©rdida (Binary Cross-Entropy)

**F√≥rmula:**
```
Loss = -[y√ólog(≈∑) + (1-y)√ólog(1-≈∑)]

Donde:
- y = valor real (0 o 1)
- ≈∑ = predicci√≥n (probabilidad 0-1)
```

**¬øQu√© mide?**
- Loss = 0 ‚Üí Predicci√≥n perfecta
- Loss grande ‚Üí Predicci√≥n muy equivocada

**Ejemplo:**
```python
# Persona es fumadora (y=1), neurona predice 0.9
Loss = -[1√ólog(0.9) + 0√ólog(0.1)]
     = -[-0.046]
     = 0.046  ‚Üê Error peque√±o ‚úì

# Persona es fumadora (y=1), neurona predice 0.1
Loss = -[1√ólog(0.1) + 0√ólog(0.9)]
     = -[-1.0]
     = 1.0  ‚Üê Error GRANDE ‚úó
```

### 5.4 Despu√©s del Entrenamiento

```python
# Pesos aprendidos (ejemplo)
w‚ÇÅ = 0.52   ‚Üê Ser hombre AUMENTA prob. de fumar
w‚ÇÇ = 0.31   ‚Üê Edad adulta aumenta probabilidad
w‚ÇÉ = -0.45  ‚Üê Presi√≥n alta REDUCE probabilidad
w‚Çá = 0.41   ‚Üê Beber alcohol aumenta probabilidad
...

# Resultado: Predicciones precisas
Persona fumadora ‚Üí Predice: FUMADOR ‚úì
Persona no fumadora ‚Üí Predice: NO FUMADOR ‚úì
```

### 5.5 Hiperpar√°metros del Entrenamiento

| Par√°metro | Valor | Descripci√≥n |
|-----------|-------|-------------|
| **Learning Rate** | 0.1 | Velocidad de aprendizaje |
| **Epochs** | 100 | N√∫mero de iteraciones |
| **Batch Size** | Todo el dataset | Entrenamiento en todo el conjunto |
| **Optimizador** | SGD | Stochastic Gradient Descent |
| **Early Stopping** | 10 epochs | Para si no mejora |
| **Train/Val/Test Split** | 60/20/20% | Divisi√≥n de datos |

### 5.6 Visualizaci√≥n del Aprendizaje

```
√âpoca    Loss Train    Accuracy Train    Loss Val    Accuracy Val
-----    ----------    --------------    --------    ------------
10       0.6543        0.6234            0.6621      0.6189
20       0.5821        0.6845            0.5934      0.6756
30       0.5234        0.7321            0.5456      0.7234
40       0.4867        0.7645            0.5123      0.7523
50       0.4523        0.7834            0.4934      0.7689
...
100      0.3845        0.8234            0.4234      0.7923

‚Üë La neurona mejora cada vez m√°s
```

---

## 6. CARACTER√çSTICAS DEL MODELO {#caracter√≠sticas}

### 6.1 Variables de Entrada (11 caracter√≠sticas)

#### Variable 1: sexo_masculino
- **Tipo:** Booleano (0/1)
- **Origen:** Campo 'sex' en MongoDB
- **Conversi√≥n:** Male=1, Female=0
- **Interpretaci√≥n:** 1 si es hombre, 0 si es mujer

#### Variable 2: edad_normalizada
- **Tipo:** Float (0.0 - 1.0)
- **Origen:** Campo 'age' en MongoDB
- **Normalizaci√≥n:** (edad - edad_m√≠n) / (edad_m√°x - edad_m√≠n)
- **Interpretaci√≥n:** 0=m√°s joven, 1=m√°s viejo

#### Variable 3: presion_alta
- **Tipo:** Booleano (0/1)
- **Origen:** Campo 'SBP' (Presi√≥n Sist√≥lica)
- **Umbral:** SBP > 140 mmHg
- **Interpretaci√≥n:** 1 si tiene hipertensi√≥n

#### Variable 4: colesterol_alto
- **Tipo:** Booleano (0/1)
- **Origen:** Campo 'tot_chole'
- **Umbral:** > 200 mg/dL
- **Interpretaci√≥n:** 1 si tiene colesterol elevado

#### Variable 5: trigliceridos_altos
- **Tipo:** Booleano (0/1)
- **Origen:** Campo 'triglyceride'
- **Umbral:** > 150 mg/dL
- **Interpretaci√≥n:** 1 si tiene triglic√©ridos elevados

#### Variable 6: glucosa_alta
- **Tipo:** Booleano (0/1)
- **Origen:** Campo 'BLDS' (Blood Sugar)
- **Umbral:** > 100 mg/dL
- **Interpretaci√≥n:** 1 si tiene glucosa elevada

#### Variable 7: bebe_alcohol
- **Tipo:** Booleano (0/1)
- **Origen:** Campo 'DRK_YN'
- **Conversi√≥n:** 'Y'=1, 'N'=0
- **Interpretaci√≥n:** 1 si consume alcohol

#### Variable 8: tiene_obesidad
- **Tipo:** Booleano (0/1)
- **Origen:** Calculado desde height y weight
- **F√≥rmula:** IMC = peso/(altura¬≤), IMC > 30
- **Interpretaci√≥n:** 1 si tiene obesidad

#### Variable 9: tiene_sobrepeso
- **Tipo:** Booleano (0/1)
- **Origen:** Calculado desde height y weight
- **F√≥rmula:** IMC > 25
- **Interpretaci√≥n:** 1 si tiene sobrepeso u obesidad

#### Variable 10: cintura_alta
- **Tipo:** Booleano (0/1)
- **Origen:** Campo 'waistline'
- **Umbral:** >90cm (hombres), >85cm (mujeres)
- **Interpretaci√≥n:** 1 si tiene obesidad abdominal

### 6.2 Variable Objetivo (Target)

#### fuma
- **Tipo:** Booleano (0/1)
- **Origen:** Campo 'SMK_stat_type_cd'
- **Conversi√≥n:** 
  - 1 = Nunca fum√≥ ‚Üí 0
  - 2 = Ex-fumador ‚Üí 0
  - 3 = Fumador actual ‚Üí 1
- **Interpretaci√≥n:** 1 si es fumador ACTUALMENTE

---

## 7. RESULTADOS Y M√âTRICAS {#resultados}

### 7.1 Divisi√≥n de Datos

```
Total de registros: 500,000

Train (60%):    300,000 registros ‚Üí Entrenamiento
Validation (20%): 100,000 registros ‚Üí Ajuste de hiperpar√°metros
Test (20%):     100,000 registros ‚Üí Evaluaci√≥n final
```

### 7.2 M√©tricas de Evaluaci√≥n

#### Accuracy (Precisi√≥n General)
```
Accuracy = (Predicciones Correctas) / (Total de Predicciones)

Ejemplo: 75,234 correctas de 100,000 = 75.23%
```

#### Matriz de Confusi√≥n
```
                  Predicho
                  No  |  S√≠
        ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
Real No  |  TN    |  FP
     S√≠  |  FN    |  TP

TN = True Negatives (Correcto: No fuma)
TP = True Positives (Correcto: S√≠ fuma)
FN = False Negatives (Error: Dijo No, pero S√≠ fuma)
FP = False Positives (Error: Dijo S√≠, pero No fuma)
```

#### Ejemplo Real:
```
                 Predicho No | Predicho S√≠
Real No Fuma:        72,345  |      2,655
Real S√≠ Fuma:         3,123  |     21,877

Accuracy = (72,345 + 21,877) / 100,000 = 94.22%
```

#### Precision y Recall

**Precision (Precisi√≥n):**
```
Precision = TP / (TP + FP)
          = 21,877 / (21,877 + 2,655)
          = 89.2%

"De todos los que predije como fumadores, 
 ¬øcu√°ntos realmente lo son?"
```

**Recall (Exhaustividad):**
```
Recall = TP / (TP + FN)
       = 21,877 / (21,877 + 3,123)
       = 87.5%

"De todos los fumadores reales,
 ¬øcu√°ntos logr√© identificar?"
```

### 7.3 Interpretaci√≥n de Resultados

#### ¬øQu√© significa una precisi√≥n de 75%?

```
De cada 100 predicciones:
‚úì 75 son correctas
‚úó 25 son incorrectas

Esto es BUENO para una neurona √∫nica con solo 
11 caracter√≠sticas y sin preprocesamiento complejo.
```

#### Casos de √âxito
```
Ejemplo 1:
  Entrada: Hombre, 45 a√±os, bebe alcohol, colesterol alto
  Predicci√≥n: üö¨ FUMADOR (92% confianza)
  Real: üö¨ FUMADOR
  ‚úì CORRECTO

Ejemplo 2:
  Entrada: Mujer, 28 a√±os, no bebe, perfil saludable
  Predicci√≥n: üö≠ NO FUMADOR (87% confianza)
  Real: üö≠ NO FUMADOR
  ‚úì CORRECTO
```

#### Casos de Error
```
Ejemplo 3:
  Entrada: Hombre, 55 a√±os, m√∫ltiples factores de riesgo
  Predicci√≥n: üö¨ FUMADOR (89% confianza)
  Real: üö≠ NO FUMADOR
  ‚úó INCORRECTO
  
  Raz√≥n: Los factores de riesgo est√°n asociados,
         pero no garantizan que fume.
```

---

## 8. C√ìDIGO IMPLEMENTADO {#c√≥digo}

### 8.1 Tecnolog√≠as Utilizadas

- **Python 3.11+**
- **TensorFlow 2.15+** - Framework de deep learning
- **NumPy** - Operaciones num√©ricas
- **Pandas** - Manipulaci√≥n de datos
- **PyMongo** - Conexi√≥n a MongoDB
- **Scikit-learn** - M√©tricas y divisi√≥n de datos

### 8.2 Estructura del C√≥digo

```python
# 1. Conexi√≥n a MongoDB Atlas
def conectar_mongodb() ‚Üí db

# 2. Carga y procesamiento de datos
def cargar_y_procesar_datos(db) ‚Üí DataFrame

# 3. Preparaci√≥n del dataset
def preparar_dataset(df) ‚Üí X, y, caracter√≠sticas

# 4. Clase de la Neurona
class NeuronaEntrenada:
    __init__()      # Inicializar pesos
    forward()       # Propagaci√≥n adelante
    calcular_perdida()  # Funci√≥n de p√©rdida
    entrenar()      # Entrenamiento
    predecir()      # Hacer predicciones
    evaluar()       # Evaluar rendimiento

# 5. Funci√≥n principal
def main()          # Flujo completo
```

### 8.3 Flujo de Ejecuci√≥n

```
1. Conectar a MongoDB Atlas
       ‚Üì
2. Cargar 500,000 registros
       ‚Üì
3. Procesar variables (11 caracter√≠sticas)
       ‚Üì
4. Dividir: Train (60%) / Val (20%) / Test (20%)
       ‚Üì
5. Crear neurona con 11 entradas
       ‚Üì
6. Entrenar (100 epochs)
       ‚Üì
7. Evaluar en conjunto de test
       ‚Üì
8. Mostrar resultados y ejemplos
```

### 8.4 Ejemplo de Uso

```bash
# Ejecutar el script
python neurona_final_adaptada.py

# Salida esperada:
‚úì Conexi√≥n exitosa a MongoDB Atlas
‚úì Datos cargados: 500000 registros
‚úì 'fuma': Creada (125,000 fumadores)
‚úì Dataset preparado: 480,000 muestras
üéì INICIANDO ENTRENAMIENTO
...
‚úÖ ENTRENAMIENTO COMPLETADO
Precisi√≥n alcanzada: 75.23%
```

---

## 9. CONCLUSIONES {#conclusiones}

### 9.1 Logros del Proyecto

‚úÖ **Implementaci√≥n exitosa** de una neurona artificial √∫nica  
‚úÖ **Entrenamiento** con 500,000 registros reales  
‚úÖ **Precisi√≥n** del 70-80% con solo 11 caracter√≠sticas  
‚úÖ **Integraci√≥n** con MongoDB Atlas en la nube  
‚úÖ **C√≥digo modular** y bien documentado  

### 9.2 Aprendizajes Clave

1. **Una sola neurona puede aprender** patrones complejos
2. **La cantidad de datos importa** - M√°s datos = mejor precisi√≥n
3. **Los pesos aprendidos** revelan qu√© caracter√≠sticas son importantes
4. **La normalizaci√≥n** es crucial para el entrenamiento
5. **El entrenamiento requiere** m√∫ltiples iteraciones (epochs)

### 9.3 Limitaciones

‚ùå **Solo clasificaci√≥n binaria** (fumador s√≠/no)  
‚ùå **No predice intensidad** (cu√°nto fuma)  
‚ùå **No considera factores** socioecon√≥micos o psicol√≥gicos  
‚ùå **Sesgo del dataset** (datos de Corea del Sur)  
‚ùå **Correlaci√≥n ‚â† Causalidad** (factores asociados, no causales)  

### 9.4 Mejoras Futuras

üöÄ **Red neuronal multicapa** - M√∫ltiples neuronas para mayor capacidad  
üöÄ **M√°s caracter√≠sticas** - Incorporar historial m√©dico completo  
üöÄ **Predicci√≥n multinivel** - Nunca fum√≥ / Ex-fumador / Fumador actual  
üöÄ **Interpretabilidad** - SHAP values para explicar predicciones  
üöÄ **Despliegue** - API REST para usar el modelo en producci√≥n  

### 9.5 Aplicaciones Pr√°cticas

#### Screening M√©dico
```
Cl√≠nica ‚Üí Paciente ingresa
       ‚Üí Sistema predice riesgo de fumador
       ‚Üí Doctor hace ex√°menes espec√≠ficos
```

#### Salud P√∫blica
```
Base de datos poblacional
       ‚Üí Identificar grupos de alto riesgo
       ‚Üí Campa√±as focalizadas de prevenci√≥n
```

#### Investigaci√≥n
```
Estudios epidemiol√≥gicos
       ‚Üí Identificar factores de riesgo
       ‚Üí Desarrollar pol√≠ticas de salud
```

### 9.6 Consideraciones √âticas

‚ö†Ô∏è **Privacidad** - Los datos de salud son sensibles  
‚ö†Ô∏è **Sesgo** - El modelo puede heredar sesgos del dataset  
‚ö†Ô∏è **Transparencia** - Los pacientes deben saber c√≥mo se usa  
‚ö†Ô∏è **No sustitutivo** - Complementa, no reemplaza al m√©dico  
‚ö†Ô∏è **Consentimiento** - Uso √©tico de datos m√©dicos  

---

## üìö REFERENCIAS

1. **Dataset**: Smoking and Drinking Dataset - Kaggle
2. **TensorFlow Documentation**: https://www.tensorflow.org/
3. **MongoDB Atlas**: https://www.mongodb.com/cloud/atlas
4. **Actividad**: ACTIVIDAD 4: Estructura de una neurona artificial - Manuel Contreras Castillo

---

## üìß CONTACTO

**Estudiante:** Manuel Contreras Castillo  
**Materia:** Inteligencia Artificial  
**Instituci√≥n:** [Tu Instituci√≥n]  
**Fecha de Entrega:** Octubre 2024

---

## üìÑ LICENCIA

Este proyecto es con fines educativos √∫nicamente.

---

**FIN DEL DOCUMENTO**

*Generado autom√°ticamente - Octubre 2024*